<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>编辑项目 - {{ project.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .info-card {
            border-left: 4px solid #0d6efd;
            border-radius: 0.375rem;
        }

        .form-label {
            font-weight: 500;
        }

        .readonly-field {
            background-color: #f8f9fa;
            color: #6c757d;
        }
    </style>
</head>

<body class="bg-light">
    <nav class="navbar navbar-dark bg-primary shadow-sm">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                    class="bi bi-pencil-square me-2" viewBox="0 0 16 16">
                    <path
                        d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                    <path fill-rule="evenodd"
                        d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
                </svg>
                编辑项目
            </span>
            <div>
                <a href="/project/{{ project.project_no }}" class="btn btn-light me-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-arrow-left me-1" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                            d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z" />
                    </svg>
                    返回项目详情
                </a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h5 class="mb-0">编辑项目信息</h5>
                    </div>
                    <div class="card-body">
                        {% if error %}
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-exclamation-triangle-fill me-2" viewBox="0 0 16 16">
                                <path
                                    d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                            </svg>
                            {{ error }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                        {% endif %}

                        <form method="post" action="/project/{{ project.project_no }}/edit">
                            <!-- 只读信息 -->
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <label class="form-label">项目序号</label>
                                    <input type="text" class="form-control readonly-field"
                                        value="{{ project.project_no }}" readonly>
                                    <div class="form-text">项目序号创建后不可修改</div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">创建日期</label>
                                    <input type="text" class="form-control readonly-field"
                                        value="{{ project.create_date }}" readonly>
                                    <div class="form-text">项目创建日期不可修改</div>
                                </div>
                            </div>

                            <!-- 可编辑信息 -->
                            <!-- 可编辑信息 -->
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label for="name" class="form-label">项目名称 <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="name" name="name"
                                        value="{{ project.name }}" required>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="project_type" class="form-label">项目类型 <span
                                            class="text-danger">*</span></label>
                                    <select class="form-select" id="project_type" name="project_type" required>
                                        <option value="">请选择项目类型</option>
                                        <option value="土地" {% if project.project_type=='土地' %}selected{% endif %}>土地
                                        </option>
                                        <option value="房地产" {% if project.project_type=='房地产' %}selected{% endif %}>房地产
                                        </option>
                                        <option value="资产" {% if project.project_type=='资产' %}selected{% endif %}>资产
                                        </option>
                                        <option value="其他" {% if project.project_type=='其他' %}selected{% endif %}>其他
                                        </option>
                                    </select>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="client_name" class="form-label">甲方名称 <span
                                            class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="client_name" name="client_name"
                                        value="{{ project.client_name }}" required>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="market_leader" class="form-label">市场部负责人</label>
                                    <select class="form-select" id="market_leader" name="market_leader">
                                        <option value="">请选择市场部负责人</option>
                                        {% for user_item in users %}
                                        <option value="{{ user_item.username }}" {% if
                                            project.market_leader==user_item.username %}selected{% endif %}>
                                            {{ user_item.realname }}
                                        </option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="project_leader" class="form-label">项目负责人 <span
                                            class="text-danger">*</span></label>
                                    <select class="form-select" id="project_leader" name="project_leader" required>
                                        <option value="">请选择项目负责人</option>
                                        {% for user_item in users %}
                                        <option value="{{ user_item.username }}" {% if
                                            project.project_leader==user_item.username %}selected{% endif %}>
                                            {{ user_item.realname }}
                                        </option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="amount" class="form-label">合同金额（元）</label>
                                    <input type="number" step="0.01" class="form-control" id="amount" name="amount"
                                        value="{{ project.amount }}">
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="is_paid" class="form-label">是否收费 <span
                                            class="text-danger">*</span></label>
                                    <select class="form-select" id="is_paid" name="is_paid" required>
                                        <option value="是" {% if project.is_paid=='是' %}selected{% endif %}>是</option>
                                        <option value="否" {% if project.is_paid=='否' %}selected{% endif %}>否</option>
                                    </select>
                                </div>

                                <div class="col-md-6 mb-3">
                                    <label for="start_date" class="form-label">开始日期 <span
                                            class="text-danger">*</span></label>
                                    <input type="date" class="form-control" id="start_date" name="start_date"
                                        value="{{ project.start_date }}" required>
                                </div>
                            </div>

                            <div class="d-flex justify-content-between mt-4">
                                <a href="/project/{{ project.project_no }}" class="btn btn-secondary">取消</a>
                                <button type="submit" class="btn btn-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-check-lg me-1" viewBox="0 0 16 16">
                                        <path
                                            d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z" />
                                    </svg>
                                    保存修改
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>